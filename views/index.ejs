<%- include('partials/header') %>

    <div class="hero-section mb-5">
        <div class="container">
            <div class="row align-items-center">
                <div class="col-md-6 fade-in" style="animation-delay: 0.2s;">
                    <h1 class="display-4 fw-bold">发现美妙音乐</h1>
                    <p class="lead">聆听数百万首歌曲，创建个性化歌单，与好友分享音乐体验。</p>
                    <% if (!locals.user) { %>
                        <a href="/auth/register" class="btn btn-primary btn-lg me-2">免费注册</a>
                        <a href="/auth/login" class="btn btn-outline-primary btn-lg">登录</a>
                        <% } else { %>
                            <a href="/search?type=song" class="btn btn-primary btn-lg">开始探索</a>
                            <% } %>
                </div>
                <div class="col-md-6 fade-in" style="animation-delay: 0.4s;">
                    <img src="/img/hero-image.jpg" alt="音乐体验" class="img-fluid rounded shadow">
                </div>
            </div>
        </div>
    </div>

    <section class="hot-songs mb-5 fade-in" style="animation-delay: 0.5s;">
        <div class="section-header d-flex justify-content-between align-items-center mb-4">
            <h2>热门歌曲</h2>
            <a href="/search?type=song&sort=hot" class="btn btn-sm btn-outline-primary">查看全部</a>
        </div>

        <div class="row">
            <% hotSongs.forEach((song, index)=> { %>
                <div class="col-md-6 col-lg-4 mb-4" style="animation-delay: <%= 0.6 + index * 0.1 %>s;">
                    <div class="card song-card h-100">
                        <div class="card-body">
                            <div class="d-flex align-items-center">
                                <img src="<%= song.coverImage %>" alt="<%= song.title %>" class="song-cover me-3">
                                <div class="song-info">
                                    <h5 class="card-title mb-1">
                                        <%= song.title %>
                                    </h5>
                                    <p class="card-text text-muted">
                                        <%= song.artist.name %>
                                    </p>
                                </div>
                                <div class="ms-auto">
                                    <button class="btn btn-play btn-sm btn-primary rounded-circle"
                                        data-id="<%= song._id %>" data-title="<%= song.title %>"
                                        data-artist="<%= song.artist.name %>" data-cover="<%= song.coverImage %>"
                                        data-audio="<%= song.audioFile %>">
                                        <i class="bi bi-play-fill"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </section>

    <section class="new-albums mb-5 fade-in" style="animation-delay: 0.6s;">
        <div class="section-header d-flex justify-content-between align-items-center mb-4">
            <h2>最新专辑</h2>
            <a href="/album" class="btn btn-sm btn-outline-primary">查看全部</a>
        </div>

        <div class="row">
            <% newAlbums.forEach((album, index)=> { %>
                <div class="col-md-4 col-lg-2 mb-4" style="animation-delay: <%= 0.7 + index * 0.1 %>s;">
                    <div class="card album-card h-100">
                        <img src="<%= album.coverImage %>" class="card-img-top" alt="<%= album.title %>">
                        <div class="card-body">
                            <h5 class="card-title text-truncate">
                                <%= album.title %>
                            </h5>
                            <p class="card-text text-muted text-truncate">
                                <%= album.artist.name %>
                            </p>
                            <!-- 添加链接 -->
                            <a href="/album/<%= album._id %>" class="stretched-link"></a>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </section>

    <section class="popular-artists mb-5 fade-in" style="animation-delay: 0.7s;">
        <div class="section-header d-flex justify-content-between align-items-center mb-4">
            <h2>流行歌手</h2>
            <a href="/artist" class="btn btn-sm btn-outline-primary">查看全部</a>
        </div>

        <div class="row">
            <% popularArtists.forEach((artist, index)=> { %>
                <div class="col-md-4 col-lg-2 mb-4" style="animation-delay: <%= 0.8 + index * 0.1 %>s;">
                    <div class="card artist-card text-center h-100">
                        <img src="<%= artist.image %>" class="card-img-top rounded-circle mx-auto mt-3"
                            alt="<%= artist.name %>" style="width: 120px; height: 120px; object-fit: cover;">
                        <div class="card-body">
                            <h5 class="card-title">
                                <%= artist.name %>
                            </h5>
                            <p class="card-text text-muted">
                                <%= artist.followers.toLocaleString() %> 粉丝
                            </p>
                            <!-- 添加链接 -->
                            <a href="/artist/<%= artist._id %>" class="stretched-link"></a>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </section>

    <section class="playlists mb-5 fade-in" style="animation-delay: 0.8s;">
        <div class="section-header d-flex justify-content-between align-items-center mb-4">
            <h2>推荐歌单</h2>
            <a href="/search?type=playlist" class="btn btn-sm btn-outline-primary">查看全部</a>
        </div>

        <div class="row">
            <% recommendedPlaylists.forEach((playlist, index)=> { %>
                <div class="col-md-4 col-lg-2 mb-4" style="animation-delay: <%= 0.9 + index * 0.1 %>s;">
                    <div class="card playlist-card h-100">
                        <img src="<%= playlist.coverImage %>" class="card-img-top" alt="<%= playlist.name %>">
                        <div class="card-body">
                            <h5 class="card-title text-truncate">
                                <%= playlist.name %>
                            </h5>
                            <p class="card-text text-muted text-truncate">by <%= playlist.creator.username %>
                            </p>
                            <!-- 添加链接 -->
                            <a href="/playlist/<%= playlist._id %>" class="stretched-link"></a>
                        </div>
                    </div>
                </div>
                <% }) %>
        </div>
    </section>

    <section class="features mb-5 fade-in" style="animation-delay: 0.9s;">
        <h2 class="text-center mb-4">网站特色</h2>

        <div class="row">
            <div class="col-md-4 mb-4 fade-in" style="animation-delay: 1s;">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-music-note-list feature-icon"></i>
                        <h4 class="card-title">个性化推荐</h4>
                        <p class="card-text">根据您的听歌习惯，智能推荐您可能喜欢的音乐和歌单。</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4 fade-in" style="animation-delay: 1.1s;">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-cloud-arrow-up feature-icon"></i>
                        <h4 class="card-title">云端同步</h4>
                        <p class="card-text">在任何设备上都能继续您的音乐之旅，播放记录和收藏自动同步。</p>
                    </div>
                </div>
            </div>
            <div class="col-md-4 mb-4 fade-in" style="animation-delay: 1.2s;">
                <div class="card feature-card h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-people feature-icon"></i>
                        <h4 class="card-title">社交分享</h4>
                        <p class="card-text">与好友分享您喜爱的音乐，评论互动，共同探索音乐世界。</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        // 添加动画类
        document.addEventListener('DOMContentLoaded', function () {
            // 获取所有需要动画的元素
            const animElements = document.querySelectorAll('.fade-in');

            // 创建观察器配置
            const config = {
                threshold: 0.1
            };

            // 创建观察器实例
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        // 元素进入视口，添加动画类
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                        // 完成后停止观察
                        observer.unobserve(entry.target);
                    }
                });
            }, config);

            // 设置初始状态并开始观察
            animElements.forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(20px)';
                el.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(el);
            });
        });
    </script>

    <%- include('partials/footer') %>